# Metaåºƒå‘Šç–²åŠ´åº¦åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ UI/UXæ”¹å–„ - æŠ€è¡“è¨­è¨ˆæ›¸

## æ¦‚è¦

æ‰¿èªã•ã‚ŒãŸè¦ä»¶å®šç¾©æ›¸ [`docs/spec/meta-ad-fatigue-ui-improvements-requirements.md`](../../spec/meta-ad-fatigue-ui-improvements-requirements.md) ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚ŒãŸåŒ…æ‹¬çš„ãªæŠ€è¡“è¨­è¨ˆæ–‡æ›¸ã§ã™ã€‚

### ä¸»è¦ãªæ”¹å–„å†…å®¹
1. **é›†ç´„æ©Ÿèƒ½ã®ç°¡ç´ åŒ–**: ã€Œé›†ç´„ï¼šONã€ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’å»ƒæ­¢ã—ã€å¸¸ã«é›†ç´„è¡¨ç¤ºã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåŒ–
2. **åª’ä½“åˆ¥ã‚°ãƒ©ãƒ•è¡¨ç¤º**: æ—¢å­˜ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã‚°ãƒ©ãƒ•ã‚’åª’ä½“åˆ¥ï¼ˆFacebook/Instagram/Audience Networkï¼‰ã®è¤‡æ•°ç·šè¡¨ç¤ºã«æ‹¡å¼µ
3. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§å‘ä¸Š**: Meta Ads Managerã¨ã®æ•°å€¤ä¸€è‡´ç‡100%é”æˆ

## è¨­è¨ˆæ–‡æ›¸æ§‹æˆ

### ğŸ“‹ [architecture.md](./architecture.md)
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼è¨­è¨ˆ
- æŠ€è¡“ä»•æ§˜ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶
- å®Ÿè£…æˆ¦ç•¥ã¨ãƒªã‚¹ã‚¯ç®¡ç†

**ä¸»è¦ãªè¨­è¨ˆæ±ºå®š:**
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ + ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ™ãƒ¼ã‚¹UI
- æ—¢å­˜AdDataAggregatorã®æ‹¡å¼µæ´»ç”¨
- React 18 + TypeScript + Rechartsç¶™ç¶šä½¿ç”¨
- Convex Database + LocalStorage ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

### ğŸ”„ [dataflow.md](./dataflow.md)
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼ã®å¯è¦–åŒ–
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ãƒ•ãƒ­ãƒ¼
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ•ãƒ­ãƒ¼

**ä¸»è¦ãªãƒ•ãƒ­ãƒ¼:**
```
Raw Meta Insights â†’ Enhanced AdDataAggregator â†’ Platform Breakdown â†’ Multi-line Chart â†’ Interactive UI
```

### ğŸ—ï¸ [interfaces.ts](./interfaces.ts)
- TypeScriptå‹å®šç¾©ã®å®Œå…¨ä»•æ§˜
- åª’ä½“åˆ¥ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®šç¾©
- ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤ºç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨æ¤œè¨¼å‹

**ä¸»è¦ãªå‹å®šç¾©:**
- `PlatformSpecificMetrics` - åª’ä½“åˆ¥ãƒ‡ãƒ¼ã‚¿å½¢å¼
- `EnhancedAdPerformanceData` - æ‹¡å¼µãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿
- `MultiLineChartData` - ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤ºç”¨ãƒ‡ãƒ¼ã‚¿
- `DataConsistencyResult` - ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯çµæœ

### ğŸ—„ï¸ [database-schema.sql](./database-schema.sql)
- Convex Databaseæ‹¡å¼µã‚¹ã‚­ãƒ¼ãƒ
- åª’ä½“åˆ¥é›†ç´„ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ãƒ¼ãƒ–ãƒ«

**ä¸»è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«:**
- `meta_insights_enhanced` - æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ
- `platform_aggregated_metrics` - åª’ä½“åˆ¥é›†ç´„ãƒ‡ãƒ¼ã‚¿
- `chart_configurations` - ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šä¿å­˜
- `chart_error_logs` - ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ­ã‚°

### ğŸ”Œ [api-endpoints.md](./api-endpoints.md)
- RESTful API + Convex Functionsè¨­è¨ˆ
- åª’ä½“åˆ¥ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤ºç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›API
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨è¨­å®šç®¡ç†API

**ä¸»è¦ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**
- `GET /api/meta/insights/enhanced` - åª’ä½“åˆ¥ã‚¤ãƒ³ã‚µã‚¤ãƒˆå–å¾—
- `GET /api/meta/insights/platform-timeseries` - æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿å–å¾—
- `POST /api/convex/aggregate-platform-data` - ãƒ‡ãƒ¼ã‚¿é›†ç´„å‡¦ç†
- `GET /api/chart/multi-line-data` - ãƒãƒ£ãƒ¼ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›

## è¦ä»¶ã¨ã®å¯¾å¿œé–¢ä¿‚

### æ©Ÿèƒ½è¦ä»¶å¯¾å¿œ
- **REQ-001~007**: é›†ç´„æ©Ÿèƒ½ã¨ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ â†’ `architecture.md`, `interfaces.ts`
- **REQ-101~103**: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ©Ÿèƒ½ â†’ `dataflow.md`, `api-endpoints.md`
- **REQ-201~202**: åˆæœŸåŒ–ã¨çŠ¶æ…‹ç®¡ç† â†’ `interfaces.ts`, `database-schema.sql`
- **REQ-301~303**: ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ â†’ `api-endpoints.md`

### éæ©Ÿèƒ½è¦ä»¶å¯¾å¿œ
- **NFR-001~003**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶ â†’ `architecture.md`, `database-schema.sql`
- **NFR-201~203**: ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ â†’ `interfaces.ts`, `dataflow.md`
- **NFR-301~303**: äº’æ›æ€§è¦ä»¶ â†’ å…¨è¨­è¨ˆæ–‡æ›¸ã§è€ƒæ…®
- **NFR-401~402**: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ â†’ `database-schema.sql`, `api-endpoints.md`

### ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å¯¾å¿œ
- **EDGE-001~003**: ã‚¨ãƒ©ãƒ¼å‡¦ç† â†’ `api-endpoints.md`, `interfaces.ts`
- **EDGE-101~103**: å¢ƒç•Œå€¤å‡¦ç† â†’ `dataflow.md`, `database-schema.sql`
- **EDGE-201~202**: ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ â†’ `interfaces.ts`, `dataflow.md`

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 0: äº‹å‰æº–å‚™ (1æ—¥)
```bash
# æ—¢å­˜ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œã¨åŸºæº–å€¤è¨˜éŒ²
npm test -- --coverage
npm run typecheck
npm run lint

# AdDataAggregatorã®æ‹¡å¼µãƒã‚¤ãƒ³ãƒˆç¢ºèª
# ç¾åœ¨ã®é›†ç´„æ©Ÿèƒ½ã®å‹•ä½œæ¤œè¨¼
```

### Phase 1: é›†ç´„æ©Ÿèƒ½ç°¡ç´ åŒ– (1æ—¥ãƒ»å¿…é ˆ)
- [ ] ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³UIå‰Šé™¤
- [ ] å¸¸æ™‚é›†ç´„ãƒ¢ãƒ¼ãƒ‰ã¸ã®åˆ‡ã‚Šæ›¿ãˆ
- [ ] æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿ç¢ºèª

**ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src/features/meta-api/components/FatigueDashboard.tsx`
- `src/features/meta-api/core/ad-data-aggregator.ts`

### Phase 2: ã‚°ãƒ©ãƒ•æ‹¡å¼µ (3-4æ—¥ãƒ»ä¸»è¦æ©Ÿèƒ½)
- [ ] AdDataAggregatorã®åª’ä½“åˆ¥å¯¾å¿œæ‹¡å¼µ
- [ ] åª’ä½“åˆ¥ãƒãƒ£ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½è¿½åŠ 
- [ ] ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å‡¡ä¾‹å®Ÿè£…

**ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
- `src/features/meta-api/core/ad-data-aggregator.ts`
- `src/features/meta-api/components/CreativeDetailModal.tsx`
- `src/components/charts/` (æ–°è¦ãƒãƒ£ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)

### Phase 3: æœ€é©åŒ– (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š
- [ ] è¿½åŠ æ©Ÿèƒ½ï¼ˆCSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç­‰ï¼‰

## æŠ€è¡“ä»•æ§˜è©³ç´°

### ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ (REQ-005æº–æ‹ )
```typescript
const PLATFORM_COLORS = {
  facebook: '#1877F2',           // é’
  instagram: '#E4405F',          // ç´«/ãƒ”ãƒ³ã‚¯  
  audience_network: '#42B883',   // ç·‘
  messenger: '#00B2FF'           // ãƒ©ã‚¤ãƒˆãƒ–ãƒ«ãƒ¼
}
```

### ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ (NFR-202æº–æ‹ )
- **ç·šã®ç¨®é¡**: Facebook(å®Ÿç·š)ã€Instagram(ç ´ç·š)ã€Audience Network(ç‚¹ç·š)
- **ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ**: WCAG 2.1 AAãƒ¬ãƒ™ãƒ«æº–æ‹  (4.5:1ä»¥ä¸Š)
- **ARIAå±æ€§**: ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™
- ã‚°ãƒ©ãƒ•æç”»æ™‚é–“: **1ç§’ä»¥å†…** (NFR-001)
- ãƒˆã‚°ãƒ«æ“ä½œå¿œç­”: **500msä»¥å†…** (NFR-002)  
- ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¡¨ç¤º: **200msä»¥å†…** (NFR-003)

## ãƒ‡ãƒ¼ã‚¿å¤‰æ›ä¾‹

### ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼
```typescript
data: [{ date: '2024-01-01', value: 1000 }]
```

### æ‹¡å¼µå¾Œã®ãƒ‡ãƒ¼ã‚¿å½¢å¼  
```typescript
data: [{ 
  date: '2024-01-01', 
  facebook: 600, 
  instagram: 350, 
  audience_network: 50,
  total: 1000,
  _metadata: {
    calculated_total: 1000,
    adjustment_applied: false
  }
}]
```

## æˆåŠŸæŒ‡æ¨™

### å®šé‡æŒ‡æ¨™
- [ ] é›†ç´„æ©Ÿèƒ½å•ã„åˆã‚ã›æ•°: **50%æ¸›å°‘**
- [ ] åª’ä½“åˆ¥åˆ†ææ™‚é–“: **30%çŸ­ç¸®**
- [ ] Meta Ads Manageræ•°å€¤ä¸€è‡´ç‡: **100%é”æˆ**
- [ ] ã‚°ãƒ©ãƒ•æç”»æ™‚é–“: **1ç§’ä»¥å†…é”æˆ**

### å®šæ€§æŒ‡æ¨™
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®ç›´æ„Ÿæ€§å‘ä¸Š
- [ ] ãƒ‡ãƒ¼ã‚¿ä¿¡é ¼æ€§ã®å‘ä¸Š
- [ ] åˆ†æåŠ¹ç‡ã®æ”¹å–„
- [ ] ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œã®é©åˆ‡æ€§

## å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: é›†ç´„æ©Ÿèƒ½ç°¡ç´ åŒ–
- [ ] `FatigueDashboard` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³å‰Šé™¤
- [ ] `enableAggregation` ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ `true` ã«å›ºå®š
- [ ] æ—¢å­˜ãƒ†ã‚¹ãƒˆã®æ›´æ–°
- [ ] UIãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

### Phase 2: ã‚°ãƒ©ãƒ•æ‹¡å¼µ
- [ ] `EnhancedAdPerformanceData` å‹å®šç¾©ã®å®Ÿè£…
- [ ] `AdDataAggregator` ã®åª’ä½“åˆ¥å¯¾å¿œæ‹¡å¼µ
- [ ] `MultiLineChart` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [ ] `PlatformLegend` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½å®Ÿè£…
- [ ] ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—æ©Ÿèƒ½å®Ÿè£…

### Phase 3: å“è³ªä¿è¨¼
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] å„ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®å‹•ä½œç¢ºèª
- [ ] ãƒ¢ãƒã‚¤ãƒ«ç’°å¢ƒã§ã®å‹•ä½œç¢ºèª
- [ ] ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ

## å‚è€ƒè³‡æ–™

- [è¦ä»¶å®šç¾©æ›¸](../../spec/meta-ad-fatigue-ui-improvements-requirements.md)
- [Meta Graph API v23.0 Documentation](https://developers.facebook.com/docs/graph-api/changelog/version23.0/)
- [Convex Database Documentation](https://docs.convex.dev/)
- [WCAG 2.1 Accessibility Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [Recharts Documentation](https://recharts.org/en-US/)

## å•ã„åˆã‚ã›

è¨­è¨ˆã«é–¢ã™ã‚‹è³ªå•ã‚„å®Ÿè£…ä¸­ã®èª²é¡Œã«ã¤ã„ã¦ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®Issueç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’é€šã˜ã¦å ±å‘Šã—ã¦ãã ã•ã„ã€‚

---

**æœ€çµ‚æ›´æ–°:** 2025-08-28  
**è¨­è¨ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 1.0.0  
**å¯¾å¿œè¦ä»¶:** meta-ad-fatigue-ui-improvements-requirements v1.0