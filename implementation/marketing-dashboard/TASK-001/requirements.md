# TASK-001: 型定義の統合とクリーンアップ - 要件定義

## 目的
既存のプロジェクトに散在する型定義を整理・統合し、新しい設計文書に基づいた一貫性のある型システムを構築する。

## 現状分析

### 既存の型定義ファイル
- `src/types/meta-api.ts` - Meta API関連の型定義（137行）
- `src/types/ecforce.ts` - ECForce関連の型定義
- `src/types/common.ts` - 共通型定義
- `src/types/meta-account.ts` - Meta Account型定義
- `src/types/index.ts` - エクスポート統合ファイル

### 散在している型定義
- `src/features/meta-api/core/types.ts` - 削除予定の古い型定義
- 各コンポーネント内のローカル型定義
- サービス内のインライン型定義

## 要件

### 機能要件

#### FR-001: 型定義の統合
- 設計文書 `docs/design/marketing-dashboard/interfaces.ts` をベースに既存型定義を統合
- 重複する型定義を排除
- 命名規則の統一

#### FR-002: 階層構造の最適化
```
src/types/
├── index.ts              # メインエクスポート
├── core/                 # コア型定義
│   ├── entities.ts       # 基本エンティティ（Account, Campaign, Ad等）
│   ├── metrics.ts        # メトリクス関連
│   └── common.ts         # 共通型・ユーティリティ型
├── api/                  # API関連
│   ├── meta.ts          # Meta API
│   ├── ecforce.ts       # ECForce API
│   └── responses.ts     # APIレスポンス共通型
├── features/            # 機能別型定義
│   ├── fatigue.ts       # 疲労度分析
│   ├── dashboard.ts     # ダッシュボード
│   └── reports.ts       # レポート
└── utils/               # ユーティリティ型
    └── helpers.ts       # TypeScriptヘルパー型
```

#### FR-003: 後方互換性の維持
- 既存コードが動作し続けるよう、必要に応じて型エイリアスを提供
- 段階的な移行を可能にする

#### FR-004: 型安全性の向上
- `any` 型の使用を最小限に抑制
- より厳密な型定義
- Union型とGeneric型の活用

### 非機能要件

#### NFR-001: 保守性
- 明確な型ドキュメント
- 型の責務が明確
- 拡張しやすい設計

#### NFR-002: パフォーマンス
- TypeScriptコンパイル時間の最適化
- 循環参照の回避

#### NFR-003: 開発体験
- IDE支援の向上
- 型推論の最適化

## 受け入れ基準

### AC-001: 型定義の網羅性
- [ ] Meta API関連の全型定義が統合されている
- [ ] ECForce関連の全型定義が統合されている  
- [ ] 疲労度分析関連の型定義が完全に定義されている
- [ ] APIレスポンス型が統一されている

### AC-002: コード品質
- [ ] TypeScriptコンパイルエラーが0件
- [ ] ESLint型関連ルール違反が0件
- [ ] 重複する型定義が0件

### AC-003: 後方互換性
- [ ] 既存コンポーネントがビルドエラーなく動作
- [ ] 型エラーによる実行時エラーが0件
- [ ] 型インポートパスの変更が最小限

### AC-004: ドキュメント
- [ ] 全ての型にTSDocコメントが記載されている
- [ ] 移行ガイドが作成されている
- [ ] 型使用例が提供されている

## 制約条件

### 技術制約
- TypeScript 5.x系を使用
- 既存のConvex型定義との互換性維持
- React/Next.jsプロジェクトとの親和性

### ビジネス制約
- 既存機能を停止させない
- 開発効率を低下させない
- 段階的な移行が可能

## リスク

### 高リスク
- 大規模な型変更による既存コードへの影響
- Convex型定義との競合

### 中リスク  
- TypeScriptコンパイル時間の増加
- 開発者の学習コスト

### 軽減策
- 段階的な移行計画
- 包括的なテスト
- 詳細なドキュメント作成

## 成功指標

### 定量的指標
- TypeScriptエラー数: 0件
- 型定義ファイル数: 現在の50%削減
- コンパイル時間: 現状維持または改善

### 定性的指標
- 開発者の型システム理解度向上
- IDE支援機能の向上
- 新機能開発の型安全性向上